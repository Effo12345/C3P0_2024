#include <autonomous.hpp>
#include <FEHSD.h>
#include <FEHRCS.h>

void showcase() {
    // Fetch lever from RCS and give to GUI
    int leverNum = RCS.GetCorrectLever();
    // int leverNum = 1;
    gui->setLeverNum(leverNum);

    // Set initial states for servos and press starting button
    fuelArm.SetDegree(0.0f);
    highButton.SetDegree(0);
    chassis->driveFor(25.0f, 0.2f);

    if(leverNum == 0) {
        // Route for first lever
        chassis->followNewPath({
            {11.58859813084112, -29.896364380693885},
        {10.319225758799796, -28.495913531001708},
        {9.053212760557711, -27.114159347759426},
        {7.796550561690725, -25.773142906253046},
        {6.55560888533167, -24.50121642030773},
        {5.339303406450261, -23.33728533377678},
        {4.160310919505794, -22.336958302722454},
        {2.8858206637855384, -21.40407081910025},
        {1.5667035124537594, -20.580016872805356},
        {0.24706100622902874, -19.923258096816916},
        {-1.0292230723448719, -19.518311320568404},
        {-2.386408136200415, -19.357909841090752},
        {-3.749252336448598, -19.297203165740612}
        },{
            78.56163126224843,
        74.61293601651482,
        70.47976142856373,
        66.17627494809147,
        61.73053527355198,
        57.20089653298077,
        52.69880891598955,
        47.6628400306965,
        42.11926072763798,
        36.08794701680842,
        29.561198684867826,
        20.893601642568207,
        0
        }, true);
    }
    else if(leverNum == 1) {
        // Route for second lever (NOT FUNCTIONAL)
        // chassis->followNewPath({
        //     {11.929439252336447, -29.644003399385472},
        // {10.514088291039087, -28.29328201677273},
        // {9.096319500990596, -26.95352147868494},
        // {7.675398543749819, -25.637477128574517},
        // {6.249266971486482, -24.361692803947857},
        // {4.814941579796545, -23.148730717086586},
        // {3.368149452577517, -22.031099524644276},
        // {1.9027311229661563, -21.056184183139152},
        // {0.40962270235936854, -20.29360679399418},
        // {-1.1526879714258444, -19.817790214755654},
        // {-2.71776342342375, -19.520466678616245},
        // {-4.361412430064332, -19.336783833814565},
        // {-6.028563080036057, -19.218812021542682},
        // {-7.66892523364486, -19.128962511535004}
        // }, {
        //     85.96723497725034,
        // 82.24538858503918,
        // 78.35876890151222,
        // 74.29897449399006,
        // 70.05724843184456,
        // 65.62708848818315,
        // 61.007306690959396,
        // 56.20198586791093,
        // 51.207029350900754,
        // 45.82082732487396,
        // 39.8718795372211,
        // 32.56570199775662,
        // 22.92820814851729,
        // 0
        // }, true);

        // Path for lever 0 (primary points only)
        chassis->followNewPath({
            {11.58859813084112, -29.896364380693885},
        {10.319225758799796, -28.495913531001708},
        {9.053212760557711, -27.114159347759426},
        {7.796550561690725, -25.773142906253046},
        {6.55560888533167, -24.50121642030773},
        {5.339303406450261, -23.33728533377678},
        {4.160310919505794, -22.336958302722454},
        {2.8858206637855384, -21.40407081910025},
        {1.5667035124537594, -20.580016872805356},
        {0.24706100622902874, -19.923258096816916},
        {-1.0292230723448719, -19.518311320568404},
        {-2.386408136200415, -19.357909841090752},
        {-3.749252336448598, -19.297203165740612}
        },{
            78.56163126224843,
        74.61293601651482,
        70.47976142856373,
        66.17627494809147,
        61.73053527355198,
        57.20089653298077,
        52.69880891598955,
        47.6628400306965,
        42.11926072763798,
        36.08794701680842,
        29.561198684867826,
        20.893601642568207,
        0
        }, true);

        //slightly altered path
        chassis->followNewPath({{11.929439252336447, -29.644003399385472},
        {10.51574577622008, -28.291967619421868},
        {9.09990875703719, -26.950685926487207},
        {7.681443446287112, -25.63267921815924},
        {6.25874054558845, -24.354182780980903},
        {4.829310822731745, -23.13733672321066},
        {3.3896487238968906, -22.014039288783295},
        {1.9347289869205988, -21.030792379291494},
        {0.4571216850166425, -20.255922416285628},
        {-1.0822798667360167, -19.76193471057698},
        {-2.6134649753540597, -19.43772315728923},
        {-4.206946824654859, -19.21423724269355},
        {-5.79931017291151, -19.049370383611787},
        {-7.328084112149532, -18.910249468531564}
        },{
        85.43555912597475,
        81.69006167538909,
        77.77643203285943,
        73.68557079406301,
        69.40807824414306,
        64.93664971808957,
        60.26968973761408,
        55.412207809525654,
        50.364736895345644,
        44.93613887094902,
        38.966832708608145,
        31.678214211184354,
        22.16368924246238,
        0
        },true);
    }
    else {
        // Route for third lever
        chassis->followNewPath({
            {11.07733644859813, -29.139281436768652},
        {9.720978170064692, -27.801465606455658},
        {8.363952837629277, -26.48385262667325},
        {7.007376602900148, -25.20970498752403},
        {5.651887267835452, -24.00936335962499},
        {4.297810201185758, -22.924475801419987},
        {2.9459457326430933, -22.01470438521666},
        {1.5974855860586623, -21.367105837884488},
        {0.04602663466761324, -20.88505086523872},
        {-1.6391895540171064, -20.514420286803794},
        {-3.409756572987594, -20.21845595073612},
        {-5.230512307755076, -19.972156514828033},
        {-7.074178690455905, -19.75816254112212},
        {-8.917103723562517, -19.564258292497907},
        {-10.736495327102803, -19.381323492843414}
        }, {
            89.17223938789618,
        85.68577378508735,
        82.07791763124193,
        78.36598477518992,
        74.57777480571093,
        70.75746326844833,
        66.97151176415143,
        63.29687292490198,
        59.047561904267035,
        54.17063146734721,
        48.57998308270863,
        42.0959173073244,
        34.32393027216662,
        24.189685539799672,
        0
        }, true);
    }

    if(leverNum == 0 || leverNum == 1) {
        // Align with lever
        chassis->turn(89.0f);

        // Actuate lever, then move arm up
        fuelArm.SetDegree(100);
        Sleep(1000);
        fuelArm.SetDegree(0);

        // Disengage from lever
        chassis->driveFor(-15.0f, 0.5f);

        // Put arm under lever
        fuelArm.SetDegree(150);
        Sleep(500);

        // Realign with lever
        chassis->driveFor(15.0f, 0.5f);

        // Wait until 5 seconds elapsed, then unflip lever
        Sleep(4.0f);
        fuelArm.SetDegree(85);
        Sleep(300);

        // Get arm out of the way
        fuelArm.SetDegree(155);
        Sleep(100);

        // Line up with wall
        chassis->followNewPath({
            {-6.390771028037383, -19.71780480125463},
        {-8.25805069709819, -19.682335918998913},
        {-10.106422649708065, -19.647244980400384},
        {-11.9103245346143, -19.612998296343296},
        {-13.639286252808482, -19.580174335015222},
        {-15.252640186915887, -19.549564147049022}
        }, {
            53.257010118965994,
        47.31460499355211,
        40.584310262122536,
        32.70678246359408,
        22.723691895485917,
        0
        }, true);
    }
    else { // Lever 3 (same as above)
        chassis->turn(89.0f);

        fuelArm.SetDegree(100);
        Sleep(1000);
        fuelArm.SetDegree(0);

        float startLeverFlip = TimeNow();

        chassis->driveFor(15.0f, 0.6f);

        fuelArm.SetDegree(150);
        Sleep(500);

        chassis->driveFor(-25.0f, 0.5f);

        Sleep(4.0f);
        fuelArm.SetDegree(75);
        fuelArm.SetDegree(75);
    }

    Sleep(500);
    fuelArm.SetDegree(110);
    Sleep(50);


    // Hard reset against wall
    chassis->getOdomModel()->setPos({{-10.65, FLT_MAX}, 90.0f});

    // Drive to ramp
    chassis->followNewPath({
        {-15.678691588785046, -18.876601530226594},
        {-13.697635474030346, -18.912729566229626},
        {-11.720528744588849, -18.94729407964697},
        {-9.749842731787613, -18.978493487759675},
        {-7.790178013392273, -19.004007376631282},
        {-5.847794186688582, -19.020641930579412},
        {-3.931566480908584, -19.02379681799927},
        {-2.054451023747191, -19.00674672422335},
        {-0.23552131293816253, -18.95961663176463},
        {1.4969616071575087, -18.867856945112383},
        {3.1014544395640384, -18.70994611232036},
        {4.790739712509163, -18.460401506391793},
        {6.525119216763312, -18.15305441787689},
        {8.271731403489634, -17.812759144942202},
        {9.999558243302191, -17.45922449997773},
        {11.673808411214953, -17.110074661067713}
    }, {
        93.83304036132351,
        90.39134968671618,
        86.82065001488695,
        83.1091253669917,
        79.24633028140016,
        75.22230550600838,
        71.02958220850304,
        66.66708201207231,
        62.146978688322214,
        57.50717670611563,
        52.831402196253485,
        47.3784706855169,
        41.0008667264209,
        33.34135465595028,
        23.3941446415975,
        0
    });

    // Get servo out of the way, and face up the ramp
    fuelArm.SetDegree(0.0f);

    chassis->turn(0.0f);
    chassis->turn(0.0f);

    // Drive to the top of the ramp
    chassis->resetSettled();
    chassis->drive(80.0f, 80.0f);
    while(chassis->getOdomModel()->getPos().p.y < 6.0f) {
        chassis->getOdomModel()->step();
        gui->setPos(chassis->getOdomModel()->getPos());
        Sleep(10);
    }
    chassis->drive(0.0f, 0.0f);
    chassis->awaitSettled();

    // Hard reset at top of ramp
    //chassis->getOdomModel()->setPos({{11.25f, FLT_MAX}, 0.0f});
    chassis->turn(-90.0f);
    Sleep(200);
    chassis->driveFor(-30.0f, 1.0f);
    chassis->getOdomModel()->setPos({{10.65, FLT_MAX},-90.0f});

    // Drive to light
    // chassis->followNewPath({
    //     {11.929439252336447, 6.359496600614531},
    //     {10.268390374274212, 6.964039511946315},
    //     {8.65559728242924, 7.615787334028187},
    //     {7.14882124577171, 8.369311821974424},
    //     {5.821416420593697, 9.29512102606056},
    //     {4.657698385703325, 10.508421359695774},
    //     {3.6024659716296012, 11.913150504704992},
    //     {2.6175044285958062, 13.443213574185155},
    //     {1.6755585367632786, 15.052088069094614},
    //     {0.7561340309747838, 16.705430181095892},
    //     {-0.15778421023263078, 18.375999620416188},
    //     {-1.0823941837713893, 20.039101733455627},
    //     {-2.035550353508112, 21.668890613082368},
    //     {-3.0395562160056033, 23.234359054545074},
    //     {-4.14575947101877, 24.74209552462062},
    //     {-5.30466359549409, 26.20811561998024},
    //     {-6.475981308411215, 27.64193935762388}
    // }, {
    //     75.06704522389676,
    //     71.19983206473238,
    //     67.17718783595866,
    //     63.03708790083313,
    //     58.786015147508756,
    //     80.95000325913423,
    //     77.39953215258899,
    //     73.54175254658756,
    //     69.36715839948916,
    //     64.85698756668613,
    //     59.975652199718965,
    //     54.664147601225295,
    //     48.826163550319144,
    //     42.29503538805359,
    //     34.50312044983127,
    //     24.34052764046295,
    //     0
    // });
    chassis->followNewPath({
        {10.906915887850467, 6.409968989412362},
        {9.338102994383965, 7.015889201789298},
        {7.8309707288499055, 7.66409186396998},
        {6.459074640173551, 8.403382746435483},
        {5.316003568474733, 9.296784472696602},
        {4.2577251430090985, 10.477932156682263},
        {3.2548106160988435, 11.850164154958678},
        {2.2866370061245362, 13.346513812078015},
        {1.337820957498389, 14.919540181860171},
        {0.39606587403502114, 16.533631885508928},
        {-0.5498158610916011, 18.159615495829915},
        {-1.5116842161278714, 19.77021642659989},
        {-2.503872678800496, 21.335744675275443},
        {-3.545418265225926, 22.81947404334669},
        {-4.701563952072918, 24.251620311327457},
        {-5.919655336495683, 25.64815720355034},
        {-7.1576635514018685, 27.01944912959928}
    },{
        73.96038371879126,
        70.22802498100258,
        66.38508120710141,
        62.51629362980385,
        60.36666989023153,
        80.30374723755024,
        76.84269187132658,
        73.03751523795866,
        68.8957935619812,
        64.40988357048423,
        59.5540342399778,
        54.2805285515996,
        48.51049730980187,
        42.10902559131286,
        34.41200493915219,
        24.31433687886733,
        0
    });

    // Sample cds here
    cds->sampleLight();

    // Drive to luggage
    // chassis->followNewPath({
    //     {-8.265397196261683, 26.127773469773413},
    //     {-6.9952679207273425, 25.089143798993423},
    //     {-5.807078286943045, 24.028258013524166},
    //     {-4.793611568984163, 22.919439888504527},
    //     {-4.075531793299784, 21.7295104127466},
    //     {-3.568122521980627, 20.28638646218746},
    //     {-3.204216374112864, 18.676638124862073},
    //     {-2.9391687482365287, 16.9611963049638},
    //     {-2.743625848092177, 15.18407394552715},
    //     {-2.5991543773501657, 13.379818255634815},
    //     {-2.4953553465939167, 11.578761369154336},
    //     {-2.4281034151082297, 9.811669913209677},
    //     {-2.394183405107433, 7.992556071193298},
    //     {-2.38131563705507, 6.149547226030781},
    //     {-2.3805584640835677, 4.3072085848119945},
    //     {-2.38588785046729, 2.4899615538855584}
    // }, {
    //     64.28425298262623,
    //     60.06191006554437,
    //     55.65708204411046,
    //     51.15670145963393,
    //     49.812886206584984,
    //     75.63816630527255,
    //     72.06257117875307,
    //     68.09962669927398,
    //     63.76086384014736,
    //     59.04437298249752,
    //     53.93462174314895,
    //     48.40521448383673,
    //     41.962449529887834,
    //     34.22089954346953,
    //     24.114757941650247,
    //     0
    // }, true);

    chassis->followNewPath({
        {-8.265397196261683, 26.127773469773413},
        {-7.031989406306003, 25.090710496046768},
        {-5.886273877959856, 24.031637426184673},
        {-4.927542000807362, 22.92530055093744},
        {-4.2851814239926, 21.738687015995026},
        {-3.886206545277995, 20.300252315266356},
        {-3.6499550056783954, 18.69713151688092},
        {-3.521103749290485, 16.9907443358951},
        {-3.461060913530708, 15.226361146916691},
        {-3.4420129038920284, 13.440279196614837},
        {-3.442581899093509, 11.665295380871475},
        {-3.448654564028766, 9.865012935912693},
        {-3.45814546654422, 8.070618109009244},
        {-3.469470775441349, 6.314108359812288},
        {-3.481369594121744, 4.633578498519968},
        {-3.4936214953271025, 3.0788038436051846}
    }, {
        63.854692984789665,
        58.037751827667755,
        51.78688974086579,
        45.141379861027325,
        44.056263830077405,
        87.10774239004927,
        82.9142157975775,
        78.2420560115549,
        73.10978958103703,
        67.52126024206753,
        61.46647594926944,
        54.64429415171919,
        46.86634310195027,
        37.7302764578327,
        26.155727636768017,
        0
    },true);

    // if(cds->getColor() == RED) {
    //     // Press red button
    // }
    // else {
    //     // Press blue button (default)
    // }

    // Press blue button
    chassis->followNewPath({
        {-3.0675700934579435, 0.891675338932287},
        {-3.090185331820164, 2.801519738289412},
        {-3.1022135979614474, 4.69763235825681},
        {-3.0892599731092356, 6.564171667027768},
        {-3.034008417143056, 8.38077793524425},
        {-2.912565115654135, 10.119130149307976},
        {-2.69067350027059, 11.738814419932831},
        {-2.330335145207166, 13.423428892517439},
        {-1.9040769192241709, 15.151542643987932},
        {-1.4741081451520208, 16.908548251259194},
        {-1.1021098022252949, 18.684344930388974},
        {-0.8490677896825513, 20.493149449695842},
        {-0.6754909623043376, 22.305116162066735},
        {-0.554296735587385, 24.09089222264416},
        {-0.46656847388521, 25.81709753822481},
        {-0.39861745242592206, 27.44092642636544},
        {-0.3408411214953271, 28.903744264165933}
    }, {
        95.07485825390117,
        91.80433333084333,
        88.43792948483684,
        84.9938845411939,
        81.50078276986639,
        78.00480157464187,
        74.57619566283346,
        70.78374144596488,
        66.63908333656364,
        62.14446971257981,
        57.28303152390675,
        51.931607170549015,
        45.9826936167947,
        39.263790976021745,
        31.441162262473874,
        21.644091128864932,
        0
    });

    chassis->driveFor(25.0f, 0.6f);

    // Try to press the top button (NOT FUNCTIONAL)
    highButton.SetDegree(70);
    Sleep(1000);
    highButton.SetDegree(0);

    // Go to passport lever
    fuelArm.SetDegree(170);

    chassis->followNewPath({
        {1.7042056074766354, 26.54837510528743},
        {1.5960476112731834, 24.758399153417965},
        {1.5233039835000337, 22.99671777806364},
        {1.5290566336958602, 21.295710308989168},
        {1.6677942574523708, 19.697411318322864},
        {2.0147008013028773, 18.260061351831894},
        {2.6360464272288584, 16.828860835885262},
        {3.425077365580731, 15.417096117473028},
        {4.301360179382748, 14.040821944166462},
        {5.197916026042569, 12.721803412035479},
        {6.049929906542055, 11.49083655388556}
    }, {
        72.09200684935382,
        67.99573840137104,
        63.71186707895904,
        59.28639391802244,
        54.785925030832026,
        50.28259110370662,
        45.04504833700058,
        38.87828897940603,
        31.45505949263066,
        21.887466004580965,
        0
    }, true);

    chassis->turn(0.0f);

    // // Move passport lever up
    chassis->driveFor(25.0f, 0.8f);
    fuelArm.SetDegree(30.0f);
    Sleep(1000);

    fuelArm.SetDegree(170);

    // chassis->driveFor(15.0f, 1.7f);

    // fuelArm.SetDegree(20.0f);
    // chassis->driveFor(25.0f, 0.5f);

    // fuelArm.SetDegree(20.0f);

    // // Move passport lever down
    // chassis->driveFor(-15.0f, 0.75f);
    // fuelArm.SetDegree(0.0f);
    // Sleep(500);

    // chassis->driveFor(15.0f, 1.25f);
    
    // fuelArm.SetDegree(20.0f);
    // Sleep(500);

    // chassis->driveFor(-15.0f, 1.0f);
    
    // fuelArm.SetDegree(0.0f);

    // Path to final button
    chassis->followNewPath({
        {6.902032710280373, 16.20157487164257},
        {6.851132220938051, 14.330800044006287},
        {6.823747342727955, 12.478478456702476},
        {6.849193947375858, 10.665995419342583},
        {6.964057636621991, 8.920883968853177},
        {7.218897397387403, 7.281209369225555},
        {7.686101954773756, 5.801500838854669},
        {8.461707543792333, 4.471073531234375},
        {9.39004088300492, 3.22660766455566},
        {10.339269330386566, 2.018447546587466},
        {11.180837995416782, 0.802354977918031},
        {11.769364486899905, -0.46704296101662},
        {12.146567538093263, -1.9615326891286085},
        {12.381181403441373, -3.6024802121822415},
        {12.519692395383531, -5.334080076091214},
        {12.593658032864775, -7.114408172322897},
        {12.624432186887567, -8.909489436075578},
        {12.626721354734807, -10.687432379263695},
        {12.610787405144888, -12.413744423980681},
        {12.583977027446377, -14.04587498405432},
        {12.551971930422782, -15.526571911606526},
        {12.51057822290877, -17.062092621979122},
        {12.424717347793992, -18.58125736046535},
        {12.252358532735334, -20.010335664208704},
        {11.957363537560314, -21.47194196803598},
        {11.589935019527454, -22.897262555819037},
        {11.188983118968157, -24.211813098198803},
        {10.712211963457408, -25.558183462534416},
        {10.225233644859813, -26.868032604992948}
    }, {
        81.21705040039993,
        76.46974835442842,
        71.46056822348496,
        66.19326360876585,
        60.67942921253624,
        54.93859363775428,
        48.964919378017434,
        72.59165838052073,
        68.18003896546237,
        63.513280606540846,
        58.67180212185478,
        54.95953207183379,
        100.4985056126686,
        97.14368632980913,
        93.49889559514945,
        89.60634970623529,
        85.5053208518235,
        81.2402740469312,
        76.8728033554399,
        72.50163858075105,
        68.29400035667284,
        63.63677448944824,
        58.66006649075055,
        53.527838610182435,
        47.63190227292339,
        40.9881803498411,
        33.619869699823674,
        23.642715975833596,
        0
    }, true);

    chassis->turn(-45.0f);
    chassis->driveFor(-50.0f, 2.0f);
}

void checkpoint5() {
    cds->sampleAmbient();

    // Await last action
    gui->pause();

    cds->awaitStartingLight();

    fuelArm.SetDegree(0.0f);
    chassis->driveFor(25.0f, 0.6f);

    // gui->pause();

    chassis->followNewPath({
        {11.929439252336447, -29.896364380693885},
        {10.610139811594301, -28.441147227296984},
        {9.291133094952452, -26.992174043709106},
        {7.9746758086484295, -25.55672020364992},
        {6.66277964759412, -24.144193490521737},
        {5.35779952116459, -22.767436147758946},
        {4.063319799538809, -21.44501650141635},
        {2.78464719605404, -20.203960135659056},
        {1.5294779121379332, -19.083955079035835},
        {0.3091467409367135, -18.14360008190264},
        {-1.0227035941292286, -17.28579558580004},
        {-2.4236344819493145, -16.563210037244968},
        {-3.8620369631577693, -16.049574758237334},
        {-5.411245755462948, -15.777414743862726},
        {-7.004092809674599, -15.660195180662088},
        {-8.580148809675348, -15.635631561552236},
        {-10.076331525495924, -15.655869127723454},
        {-11.418177570093457, -15.68002910032005}
    }, {
        96.03987729420435,
        92.709782329192,
        89.26416615300936,
        85.70194320395022,
        82.02399749052866,
        78.23625075462719,
        74.355500476502,
        70.41681148841487,
        66.4847141318334,
        62.66755440440299,
        58.48317696452021,
        53.99874452949904,
        49.265706174968734,
        43.86081588784858,
        37.58565901621646,
        30.137727080867286,
        20.723424639281784,
        0
    }, true);

    chassis->getOdomModel()->setPos({{-10.65, FLT_MAX}, 90.0f});

    chassis->driveFor(20.0f, 0.17f);

    // gui->pause();

    chassis->turn(4.5f);

    // gui->pause();

    chassis->drive(50.0f, 50.0f);
    while(chassis->getOdomModel()->getPos().p.y < 9.0f) {
        chassis->getOdomModel()->step();
        gui->setPos(chassis->getOdomModel()->getPos());
        Sleep(10);
    }
    chassis->drive(0.0f, 0.0f);

    chassis->getOdomModel()->setPos({{-11.25, 10.9}, 2.0f});

    // gui->pause();

    chassis->followNewPath({
        {-10.56607476635514, 10.39727230154911},
        {-9.166897439747625, 11.462115427703774},
        {-7.820456772109334, 12.536415928274804},
        {-6.585454366747771, 13.630863917145469},
        {-5.53889927985938, 14.759435590895261},
        {-4.787373789812542, 15.941156594125605},
        {-4.330896825571961, 17.292280059447304},
        {-4.058074421353816, 18.71418983736787},
        {-3.8862061012642717, 20.119177948470274},
        {-3.749252336448598, 21.4170351520164}
    }, {
        65.35573781745336,
        60.89925508393487,
        56.19179315147088,
        51.27830481496775,
        46.22704601031044,
        41.094967657213004,
        36.52230331362794,
        29.505385272541186,
        20.435757559635807,
        0
    });

    chassis->followNewPath({
        {-4.34572429906542, 21.585275806222008},
        {-4.416207473097538, 19.629437087688217},
        {-4.484864388537699, 17.68044306860142},
        {-4.547442642360582, 15.745360668793168},
        {-4.599713897242604, 13.834553331347427},
        {-4.635890187673961, 11.961514913275497},
        {-4.651034006949734, 10.06992927830876},
        {-4.6522863929707725, 8.176812996488756},
        {-4.6446189631479005, 6.298766298302035},
        {-4.631638941779598, 4.4549219649337015},
        {-4.616095505733398, 2.669463049534879},
        {-4.601355140186915, 0.9757956660350907}

    }, {
        81.21928550427782,
        77.26770137562686,
        73.11793719101637,
        68.75087390559499,
        64.14823124494438,
        59.29174895175841,
        53.9461276879896,
        48.00403472401535,
        41.27235633958563,
        33.367088445845376,
        23.28076649344407,
        0
    }, true);

    chassis->getOdomModel()->setPos({{-3.66, 3.84}, 0.0f});

    chassis->followNewPath({
        {-4.090093457943925, 0.47107370341826826},
        {-2.8281961787175933, 1.8002034753038174},
        {-1.5706371220549258, 3.097233497185982},
        {-0.3202653558511755, 4.325107059134597},
        {0.9178389313190702, 5.435939881271939},
        {2.1366962655468105, 6.3635639299067055},
        {3.326391893549544, 7.01324567882167},
        {4.472464128711336, 7.2468892867971},
        {5.638170163778874, 6.962607039138722},
        {6.760116934603635, 6.309061604036254},
        {7.768103523515262, 5.377262473928106},
        {8.574157659352586, 4.214818359796255},
        {9.122367433987476, 2.783301655529546},
        {9.495118337079726, 1.1714243643498903},
        {9.747398032063277, -0.5602691998330842},
        {9.915398977083557, -2.3699244140340934},
        {10.022165788701859, -4.227843715923733},
        {10.08118310366187, -6.111866184512825},
        {10.09847960770517, -8.003909335333097},
        {10.07356943890132, -9.887141106772393},
        {9.999375632544853, -11.743352235710146},
        {9.861127820822388, -13.550117482327357},
        {9.634062579216925, -15.277295069762028},
        {9.279558626236746, -16.88232572952889},
        {8.739116221606679, -18.303577776802467},
        {7.92668257268038, -19.596015726702408},
        {6.983424194607284, -20.801239236831517},
        {6.030065660115414, -21.947240855058958},
        {5.185760646489524, -23.05277388345248},
        {4.586691036545945, -24.130274409554175},
        {4.407302711446397, -25.187796415586924},
        {4.795914221295999, -26.28504469901945},
        {5.563000310593911, -27.406581312952984},
        {6.578135713187357, -28.540765892239108},
        {7.74959196070314, -29.677930678528423},
        {9.010026433446667, -30.808869982801866},
        {10.305994137058148, -31.92341023566385},
        {11.58859813084112, -33.008816483497625}

    }, {
        62.576300607466145,
        57.70020416646467,
        52.45194985048383,
        46.80193405487768,
        40.72023608401494,
        34.1759298593271,
        27.096577734907413,
        18.972030012617445,
        30.388590330206846,
        42.728480424602274,
        44.63675268668503,
        42.8740512883555,
        80.28084768840536,
        95.71651207765919,
        92.74512994376792,
        89.554895850478,
        86.16591166421827,
        82.59165465810405,
        78.84099385661085,
        74.92139499804793,
        70.84316174218687,
        66.62506009778471,
        62.30125236330301,
        57.926310881011226,
        53.5619769803192,
        48.789138232554876,
        43.48141692794609,
        37.597963483449064,
        31.120201355487595,
        23.957430596333793,
        15.587418981488819,
        34.196278348986745,
        51.34268729635738,
        46.35720531386099,
        40.33052879261795,
        32.93406545270302,
        23.187804006703043,
        0
    });

    chassis->driveFor(25.0f, 0.8f);
}


void checkpoint4() {
    // fuelArm.SetDegree(0.0f);
    // chassis->turn(30.0f, 2.0f);
    // // gui->pause();
    // // chassis->drive(30.0f, -30.0f);
    // // float start = TimeNow();
    // // while(TimeNow() - start < 0.3f) {
    // //     chassis->getOdomModel()->step();
    // //     Sleep(10);
    // // }

    // chassis->followNewPath({
    //     {7.498504672897196, -23.92382115639482},
    //     {8.187578317568883, -22.340480611673183},
    //     {8.860558055476755, -20.79720624909367},
    //     {9.500942845723042, -19.34042037748574},
    //     {10.134613594435189, -17.916422521502565},
    //     {10.729740921121525, -16.58689912171306},
    //     {11.247757009345793, -15.42766811901164}
    // }, {
    //     54.51374149472097,
    //     49.18512481438922,
    //     43.36376471282438,
    //     37.0296075963485,
    //     29.53696303972732,
    //     20.157043589432202,
    //     0
    // });

    // gui->pause();

    // chassis->turn(-0.5f);

    // gui->pause();

    // chassis->drive(50.0f, 52.0f);
    // while(chassis->getOdomModel()->getPos().p.y < 8.5f) {
    //     chassis->getOdomModel()->step();
    //     Sleep(10);
    // }
    // chassis->drive(0.0f, 0.0f);
    // Sleep(100);

    // gui->pause();

    // chassis->turn(-40.0f);
    // fuelArm.SetDegree(180.0f);

    // gui->pause();

    // chassis->followNewPath({
    //     {11.673808411214953, 8.210143796876213},
    //     {10.186323810518628, 9.167509410294594},
    //     {8.727561624020368, 10.105758119656533},
    //     {7.334153885384157, 11.001972063567898},
    //     {6.049929906542055, 11.827317862296773}
    // }, {
    //     49.06334767288353,
    //     42.076033594641515,
    //     33.85251216010469,
    //     23.442834538018282,
    //     0
    // });

    // gui->pause();

    // chassis->turn(0.5f);

    // gui->pause();

    // fuelArm.SetDegree(15.0f);
    //     chassis->followNewPath({
    //     {7.413294392523364, -25.47163498255026},
    //     {6.238467654984828, -24.04745413162802},
    //     {5.04916143922094, -22.662760780505057},
    //     {3.830869391310792, -21.363201969994595},
    //     {2.563412930195895, -20.207714673745567},
    //     {1.2191110919216421, -19.27770418082923},
    //     {-0.30755383003082937, -18.58886554383184},
    //     {-1.9433621427644174, -18.0554841889554},
    //     {-3.632183071786059, -17.616195752644217},
    //     {-5.3262910098358835, -17.22428614189527},
    //     {-6.97872438724949, -16.840416936975565},
    //     {-8.535959192916872, -16.426533378261336},
    //     {-9.929655137506735, -15.9399037907259},
    //     {-11.06597264639795, -15.326423588510053},
    //     {-11.810897764591518, -14.512181397538376},
    //     {-12.151814532686997, -13.379130781910797},
    //     {-12.265024747559284, -12.037273701277707},
    //     {-12.291313828801204, -10.564028007400035},
    //     {-12.321039559394345, -8.930387358283928},
    //     {-12.350033455172088, -7.193399534944088},
    //     {-12.373999634575485, -5.393986345654},
    //     {-12.38785143016705, -3.5633250742401508},
    //     {-12.384925536285682, -1.7277272174723033},
    //     {-12.355939572853076, 0.08727536133278845},
    //     {-12.2875556352936, 1.8529372860453788},
    //     {-12.1602846297485, 3.5328056875894776},
    //     {-11.94544472369741, 5.077048025077825},
    //     {-11.600684025716784, 6.414660766563148},
    //     {-11.071783755686884, 7.739877630733392},
    //     {-10.318907615560708, 8.950320187867252},
    //     {-9.261634899362484, 9.966446781248981},
    //     {-8.016458203369043, 10.811980491842773},
    //     {-6.6705464720631396, 11.484022595203536},
    //     {-5.295347734538637, 11.952589220766933},
    //     {-3.736046656317503, 12.262165010149731},
    //     {-2.061402836015196, 12.464700640097204},
    //     {-0.322167151155833, 12.595457443217128},
    //     {1.4409793018518413, 12.67849072702851},
    //     {3.1910983576547176, 12.730399348384797},
    //     {4.889206725319882, 12.762931496572701},
    //     {6.4882156317546515, 12.784816335436949},
    //     {7.924556074766355, 12.803113849225447}
    // },{
    //     83.05823659398345,
    //     79.42217537455875,
    //     75.65564585325802,
    //     71.7896612100012,
    //     67.85956655783423,
    //     63.88923314419525,
    //     65.15578779849436,
    //     60.78399435089911,
    //     56.00257107639197,
    //     50.792286607484705,
    //     45.13310521092042,
    //     39.004896685671916,
    //     32.38818737145375,
    //     25.214357889373712,
    //     18.023100073884898,
    //     42.78027977124992,
    //     92.23520943606394,
    //     89.64273638106039,
    //     86.67738253437744,
    //     83.40896300820422,
    //     79.88236237959877,
    //     76.12728448511598,
    //     72.16627593762261,
    //     68.02276454485285,
    //     63.73116253879282,
    //     59.35118043270325,
    //     54.98768695122594,
    //     50.80965135051525,
    //     46.09799152887806,
    //     40.851819715262174,
    //     61.72134885862475,
    //     72.06208686297916,
    //     68.64070978182292,
    //     65.16625047785176,
    //     61.13857241053446,
    //     56.55204695594077,
    //     51.381007695036814,
    //     45.5540972550392,
    //     38.92160576127974,
    //     31.16724253183479,
    //     21.439828239051852,
    //     0
    // });

    // float startRun = TimeNow();
    // while(cds.Value() > 1.3f && (TimeNow() - startRun) < 30.0f) {
    //     // LCD.WriteAt(cds.Value(), 0 , 160);
    //     gui->setLightLevel(cds.Value());
    //     gui->update();
    //     Sleep(100);
    // }

    fuelArm.SetDegree(0.0f);
    chassis->followNewPath({
        {7.498504672897196, -23.92382115639482},
        {8.184817638041485, -22.316180802914026},
        {8.854736529586974, -20.74450174973079},
        {9.491235776469416, -19.250895580872886},
        {10.11933160264767, -17.776512829330414},
        {10.714984666591082, -16.3780489503833},
        {11.247757009345793, -15.124834748905398}
    },{
        55.32296234802233,
        50.01267348595512,
        44.21027097981822,
        37.88145407545221,
        30.36732371282697,
        20.87494728116159,
        0
    });
    chassis->turn(-3.5f);

    chassis->drive(50.0f, 52.0f);
    while(chassis->getOdomModel()->getPos().p.y < 8.5f) {
        chassis->getOdomModel()->step();
        Sleep(10);
    }
    chassis->drive(0.0f, 0.0f);
    Sleep(100);

    chassis->turn(-60.0f, 2.0f);
    fuelArm.SetDegree(180.0f);

    chassis->followNewPath({
        {11.247757009345793, 7.200699871642568},
        {9.499688685252755, 7.377673813173258},
        {7.789800559149741, 7.582232581007541},
        {6.164344139300812, 7.8463761725222705},
        {4.681757452538659, 8.211262991961949},
        {3.4227736716765786, 8.733857648731762},
        {2.503099045711515, 9.495687114304108},
        {1.987199117562537, 10.615702125321967},
        {1.729877834441553, 11.963381105266851},
        {1.6262273164943473, 13.443661332436902},
        {1.5953035592781584, 14.982207370793489},
        {1.587130711852003, 16.606177104799883},
        {1.5928231593568967, 18.256963713688638},
        {1.605665059726284, 19.88017506065261},
        {1.6189953271028037, 21.4170351520164}
    },{
        57.57855514634803,
        52.469503242096074,
        46.92529135919186,
        40.92693188797903,
        34.4445727391208,
        27.390224826981683,
        19.185170870347438,
        37.731809082838886,
        55.01338946877307,
        50.513597535916055,
        45.37829179529819,
        39.236621547543606,
        31.800276963028622,
        22.176873732166488,
        0
    });

    // chassis->turn(0.0f);

    chassis->driveFor(-25.0f, 0.25f);
    fuelArm.SetDegree(40.0f);
    Sleep(1000);

    chassis->driveFor(15.0f, 1.6f);

    chassis->driveFor(-15.0f, 0.75f);
    fuelArm.SetDegree(0.0f);
    Sleep(500);

    chassis->driveFor(15.0f, 1.25f);
    
    fuelArm.SetDegree(20.0f);
    Sleep(500);

    chassis->driveFor(-15.0f, 1.0f);
}

void armTesting() {
    fuelArm.SetDegree(180.0f);
    Sleep(3000);
    fuelArm.SetDegree(15.0f);
    Sleep(1000);

    chassis->driveFor(15.0f, 1.6f);

    chassis->driveFor(-15.0f, 0.75f);
    fuelArm.SetDegree(0.0f);
    Sleep(500);

    chassis->driveFor(15.0f, 1.25f);
    
    fuelArm.SetDegree(20.0f);
    Sleep(500);

    chassis->driveFor(-15.0f, 1.0f);



}

void rampTesting() {
    chassis->followNewPath({
        {-12.270280373831774, -12.399336343310704},
        {-12.283919192006229, -10.405019939694302},
        {-12.298551518264697, -8.411587960926903},
        {-12.31316936768545, -6.420128231188221},
        {-12.327763322920163, -4.431923721004142},
        {-12.342320444249149, -2.4487372704418457},
        {-12.356821462947943, -0.473193950243292},
        {-12.371238916594713, 1.4909649021625566},
        {-12.385529556873045, 3.4378473612253018},
        {-12.399635644898833, 5.35958738186385},
        {-12.413464702040537, 7.243586156598581},
        {-12.426884983552453, 9.071895466912254},
        {-12.44070093457944, 10.81787393706313}
    }, {
        107.74468960310726,
        103.01328369534644,
        98.05607465819993,
        92.83984644607615,
        87.321864687555,
        81.44622836138579,
        75.13780569201447,
        68.29043828654645,
        60.74632917226983,
        52.2419430373357,
        42.27523918373538,
        29.546853742809944,
        0
    });
}

void checkpoint3() {
    //
    // RCS example
    //

    // float startRun = TimeNow();
    // while(cds.Value() > 1.3f && (TimeNow() - startRun) < 30.0f) {
    //     // LCD.WriteAt(cds.Value(), 0 , 160);
    //     gui->setLightLevel(cds.Value());
    //     gui->update();
    //     Sleep(100);
    // }

    int leverNum = RCS.GetCorrectLever();

    fuelArm.SetDegree(0);

    if(leverNum == 0) {
        // Route for first lever
        chassis->followNewPath({
            {11.162546728971963, -29.307522090974256},
            {9.847417073341987, -27.951785015703035},
            {8.53167702163259, -26.61915983990929},
            {7.216756692440986, -25.336350870762963},
            {5.903163939710989, -24.13790820429326},
            {4.591724956635418, -23.071451029466573},
            {3.2835146547830374, -22.20527568968558},
            {1.9801245484854468, -21.638793970536113},
            {0.6133096285331933, -21.43771592325527},
            {-0.7504333955683832, -21.43252289578249},
            {-2.0450467289719625, -21.48433167041351}
        },{
            71.77314217140857,
            67.43119410919367,
            62.830702015705526,
            57.96424042626897,
            52.82847308683259,
            47.43356556408922,
            41.80755939963654,
            35.95966170057851,
            29.1720550698333,
            20.361921946445356,
            0
        }, true);
    }
    else if(leverNum == 1) {
        // Route for second lever
        chassis->followNewPath({
            {11.162546728971963, -29.307522090974256},
            {9.832716373027845, -28.006726615846098},
            {8.501974113822424, -26.73591687037791},
            {7.1714618260834, -25.52967529108964},
            {5.841138068475703, -24.43260433277717},
            {4.511244326546687, -23.50651174505205},
            {3.181867926872853, -22.83982018899007},
            {1.6840157547121966, -22.371541513448197},
            {0.0959761669358477, -22.036383564744717},
            {-1.5180692799301223, -21.78981795519456},
            {-3.0981294719641985, -21.601094471101522},
            {-4.578574285606802, -21.44854995580117},
            {-5.879509345794392, -21.316091016207903}
        }, {
            79.07603105583016,
            75.21794836130206,
            71.19634506052243,
            67.03901351372303,
            62.78887334412639,
            58.51374595960244,
            54.29511271018834,
            49.45471289800601,
            43.89079141485108,
            37.46885675777605,
            29.911571927394714,
            20.456087933190283,
            0
        }, true);
    }
    else {
        // Route for third lever
        chassis->followNewPath({
            {11.07733644859813, -29.139281436768652},
            {9.721450043711023, -27.820953591796616},
            {8.36478490317303, -26.525779840284017},
            {7.008943294375189, -25.28079574352913},
            {5.654208564895897, -24.120705995838893},
            {4.301283990051855, -23.093423992726084},
            {2.95118876026827, -22.267653965927767},
            {1.6052529104768078, -21.743541416568753},
            {0.057488793486519904, -21.443702134631284},
            {-1.6227005556532101, -21.29425846665473},
            {-3.386497237235771, -21.244903001611814},
            {-5.198202396413252, -21.260842442590278},
            {-7.029631806605089, -21.317590254797143},
            {-8.855652426553718, -21.396977768309068},
            {-10.65128504672897, -21.48433167041351}
        }, {
            83.5195202276442,
            79.81444087733276,
            75.96144436932896,
            71.97990692958089,
            67.8996706732398,
            63.77122304761805,
            59.66853278566036,
            58.80481505601351,
            58.572061001887356,
            53.767119843482334,
            48.23139337609491,
            41.79113804123654,
            34.061129418207656,
            23.9850364019503,
            0
        }, true);
    }

    if(leverNum == 0 || leverNum == 1) {
        chassis->turn(89.0f);

        fuelArm.SetDegree(100);
        Sleep(1000);
        fuelArm.SetDegree(0);

        float startLeverFlip = TimeNow();

        float moveStart = TimeNow();
        chassis->drive(-15.0f, -15.0f);
        while(TimeNow() - moveStart < 0.5f) {
            chassis->getOdomModel()->step();
            Sleep(10);
        }
        chassis->drive(0.0f, 0.0f);

        fuelArm.SetDegree(150);
        Sleep(500);

        moveStart = TimeNow();
        chassis->drive(15.0f, 15.0f);
        while(TimeNow() - moveStart < 0.5f) {
            chassis->getOdomModel()->step();
            Sleep(10);
        }
        chassis->drive(0.0f, 0.0f);

        Sleep(4.0f);
        fuelArm.SetDegree(100);
    }
    else {
        chassis->turn(89.0f);

        fuelArm.SetDegree(100);
        Sleep(1000);
        fuelArm.SetDegree(0);

        float startLeverFlip = TimeNow();

        float moveStart = TimeNow();
        chassis->drive(15.0f, 15.0f);
        while(TimeNow() - moveStart < 0.5f) {
            chassis->getOdomModel()->step();
            Sleep(10);
        }
        chassis->drive(0.0f, 0.0f);

        fuelArm.SetDegree(150);
        Sleep(500);

        moveStart = TimeNow();
        chassis->drive(-15.0f, -15.0f);
        while(TimeNow() - moveStart < 0.5f) {
            chassis->getOdomModel()->step();
            Sleep(10);
        }
        chassis->drive(0.0f, 0.0f);

        Sleep(4.0f);
        fuelArm.SetDegree(100);
    }
    
}

void checkpoint2() {
    FEHFile* posOut = SD.FOpen("moves.txt", "w");
    gui->clear();

    // chassis->turn(45.0f);
    // Sleep(100);

    // float startRun = TimeNow();
    // while(cds.Value() > 1.1f && (TimeNow() - startRun) < 30.0f) {
    //     // LCD.WriteAt(cds.Value(), 0 , 160);
    //     Sleep(100);
    // }

    starlib::Odom::Pose position = chassis->getOdomModel()->getPos();
    SD.FPrintf(posOut, "Start");
    SD.FPrintf(posOut, " %f %f %f\n", position.p.x, position.p.y, position.a);

    chassis->followNewPath({
        {6.475981308411215, -24.260302464806035},
        {4.690354859923755, -23.48359715585645},
        {2.9164050743649668, -22.697147896103065},
        {1.1698442518903804, -21.889663874380744},
        {-0.5302869639879365, -21.046465996301738},
        {-2.157670655718212, -20.147411593159596},
        {-3.674818961158477, -19.163495968823632},
        {-5.127256641994576, -18.01436584613621},
        {-6.537056803962704, -16.756211582109117},
        {-7.919649510810176, -15.428399240806913},
        {-9.286157608749, -14.059479924362787},
        {-10.646219015981458, -12.67155214682717}
    }, {
        81.8058840978188,
        77.90434358568933,
        73.81150513693478,
        69.5154490543608,
        65.00092207311562,
        60.2509037889402,
        55.24061930385303,
        49.587006624310334,
        43.06051151614531,
        35.22481724393297,
        24.936538285691046,
        0,
    });
    Sleep(100);

    gui->pause();

    position = chassis->getOdomModel()->getPos();
    SD.FPrintf(posOut, "To ramp");
    SD.FPrintf(posOut, " %f %f %f\n", position.p.x, position.p.y, position.a);

    chassis->turn(2.3f);
    Sleep(100);

    gui->pause();

    position = chassis->getOdomModel()->getPos();
    SD.FPrintf(posOut, "Align ramp");
    SD.FPrintf(posOut, " %f %f %f\n", position.p.x, position.p.y, position.a);

    chassis->drive(50.0f, 50.0f);
    while(chassis->getOdomModel()->getPos().p.y < 9.0f) {
        chassis->getOdomModel()->step();
        gui->setPos(chassis->getOdomModel()->getPos());
        gui->update();
        Sleep(10);
    }
    chassis->drive(0.0f, 0.0f);
    Sleep(100);

    gui->pause();

    position = chassis->getOdomModel()->getPos();
    SD.FPrintf(posOut, "Ramp top");
    SD.FPrintf(posOut, " %f %f %f\n", position.p.x, position.p.y, position.a);

    chassis->turn(35.0f);
    Sleep(100);

    gui->pause();

    position = chassis->getOdomModel()->getPos();
    SD.FPrintf(posOut, "Light align");
    SD.FPrintf(posOut, " %f %f %f\n", position.p.x, position.p.y, position.a);

    
    chassis->followNewPath({
        {-6.987242990654205, 10.565512955754718},
        {-6.631263564372162, 12.497932433532984},
        {-6.277256760786646, 14.425057195887943},
        {-5.925388383092541, 16.340540900935363},
        {-5.577151879467246, 18.23625358920891},
        {-5.234583213372861, 20.101111983315782},
        {-4.900588002802528, 21.919298623456367},
        {-4.579468448021306, 23.667393404199178},
        {-4.277453491355618, 25.311487516789903},
        {-4.004883177570093, 26.80073608659584}
    }, {
        81.25731009021703,
        76.26779638329391,
        70.94384242805704,
        65.22281140274217,
        59.01730431439476,
        52.19786885137709,
        44.55529024000087,
        35.69644417466868,
        24.608833778288325,
        0
    });
    Sleep(100);

    gui->pause();

    position = chassis->getOdomModel()->getPos();
    SD.FPrintf(posOut, "Light path");
    SD.FPrintf(posOut, " %f %f %f\n", position.p.x, position.p.y, position.a);

    bool isBlue = false;
    bool isRed = false;
    // float lightValue = cds.Value();

    // if(lightValue > 0.9f) { // Blue light
    //     // LCD.Clear(BLUE);
    //     gui->setColor(BLUE);
    //     isBlue = true;
    // }
    // else {
    //     // LCD.Clear(RED);
    //     gui->setColor(RED);
    //     isRed = true;
    // }

    // LCD.WriteAt(lightValue, 0, 160);


    chassis->followNewPath({
        {-3.5788317757009342, 26.464254778184625},
        {-3.8820821596777453, 24.846135609468433},
        {-4.105000222108283, 23.259734731847185},
        {-4.152488740395803, 21.741864806020455},
        {-3.903346364524626, 20.339844821704045},
        {-3.2529056137939865, 18.979776465409575},
        {-2.33789713366057, 17.650813772461177},
        {-1.2540698422918704, 16.347061498476005},
        {-0.07063476044405659, 15.066390057943053},
        {1.1585649644660037, 13.810353843272768},
        {2.38588785046729, 12.584400806222007}
    }, {
        58.63154660579609,
        53.952251935671676,
        48.97152093588722,
        43.72932455830766,
        38.165151312173094,
        52.29094380367214,
        47.09588934474705,
        40.93272708451573,
        33.428887870517535,
        23.560837416297144,
        0
    }, true);
    Sleep(100);

    gui->pause();

    position = chassis->getOdomModel()->getPos();
    SD.FPrintf(posOut, "Luggage path");
    SD.FPrintf(posOut, " %f %f %f\n", position.p.x, position.p.y, position.a);

    chassis->turn(3.0f);
    Sleep(100);

    gui->pause();

    position = chassis->getOdomModel()->getPos();
    SD.FPrintf(posOut, " Button turn");
    SD.FPrintf(posOut, " %f %f %f\n", position.p.x, position.p.y, position.a);

    if(isBlue) {
        chassis->followNewPath({
            {2.4710981308411215, 12.500280479119205},
            {2.364182379103605, 14.418177693769296},
            {2.267094746353529, 16.32461750728169},
            {2.193388803007719, 18.20615240216336},
            {2.1591968917435636, 20.045331507408655},
            {2.1825621583440333, 21.867335768138776},
            {2.241163944231351, 23.645656299821976},
            {2.318146691966515, 25.346538379631706},
            {2.399556812709748, 26.92471117317729},
            {2.4710981308411215, 28.314901974446308}
        }, {
            71.1699375806957,
            66.71191812846374,
            61.96473758896679,
            56.895305134228614,
            51.462964705979175,
            45.44609370799173,
            38.677848519637855,
            30.8405009936795,
            21.10567996548882,
            0
        });

        position = chassis->getOdomModel()->getPos();
        SD.FPrintf(posOut, " Blue press");
        SD.FPrintf(posOut, " %f %f %f\n", position.p.x, position.p.y, position.a);
    }
    else if (isRed) {
        chassis->followNewPath({
            {2.4710981308411215, 12.500280479119205},
            {3.3808242380413502, 13.908478673184971},
            {4.201220234538762, 15.325473108767609},
            {4.831284232366762, 16.761559845564122},
            {5.271049508734557, 18.3506794921803},
            {5.582630211264703, 20.02874193865011},
            {5.808127116927789, 21.745591660350314},
            {5.976238855150036, 23.457066065023838},
            {6.106735169777372, 25.118310783631568},
            {6.21344679070188, 26.67639270067122},
            {6.305560747663551, 28.062540993137898}
        }, {
            72.23575725803994,
            68.42168769611432,
            64.47925701395472,
            60.46274044671931,
            55.92952802711366,
            50.81293072700767,
            45.031583091439224,
            38.43872956434318,
            30.729464616833017,
            21.084254245965255,
            0
        });

        position = chassis->getOdomModel()->getPos();
        SD.FPrintf(posOut, "Red press");
        SD.FPrintf(posOut, " %f %f %f\n", position.p.x, position.p.y, position.a);
    }
    Sleep(100);

    gui->pause();

    chassis->followNewPath({
        {4.516144859813084, 27.89430033893229},
        {4.036361579479535, 26.04973515421361},
        {3.543748403515439, 24.22295679847026},
        {3.025632586320412, 22.434521782935413},
        {2.4643112031896606, 20.711010229227732},
        {1.8353451366482842, 19.089131031218162},
        {1.103768569916942, 17.621416789393194},
        {0.21861540314188746, 16.384488685912025},
        {-0.9384517686418987, 15.281091040904206},
        {-2.2585992712990026, 14.25606012622874},
        {-3.6585044647879843, 13.266343763157256},
        {-5.067223453270739, 12.274434892362823},
        {-6.415201055591579, 11.2425046661457},
        {-7.623427053429274, 10.126453906467551},
        {-8.591069390052589, 8.86904867746786},
        {-9.224018703208424, 7.373106587560481},
        {-9.63100464178213, 5.717165758813131},
        {-9.885533670945978, 3.954760834531265},
        {-10.037268895608525, 2.122826334197863},
        {-10.11985112825937, 0.24743203104209147},
        {-10.156123319914679, -1.6521444467262427},
        {-10.161691157450855, -3.560387546939642},
        {-10.147375558811618, -5.463132021660943},
        {-10.12091088252755, -7.345346036804331},
        {-10.088108236425146, -9.188825882202059},
        {-10.05481308411215, -10.969290782563041}
    }, {
        85.6071642996064,
        81.96758702875368,
        78.18717880822521,
        74.27922683855952,
        70.266397971475,
        66.18689833172775,
        62.09610342507143,
        58.04482056253117,
        71.864535057951,
        68.04170035243426,
        63.88313646851508,
        59.41151606138693,
        54.64877769465519,
        49.59991638173192,
        44.186305757875445,
        73.51162401264607,
        73.13336722357417,
        69.12791525321421,
        64.73362495228167,
        59.91439282990217,
        54.60548678718489,
        48.694135128214434,
        41.97884385391046,
        34.05664858424201,
        23.871497227359356,
        0
    }, true);
    Sleep(100);

    gui->pause();

    SD.FClose(posOut);
}